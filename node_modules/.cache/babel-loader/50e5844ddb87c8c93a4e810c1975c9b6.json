{"ast":null,"code":"const {\n  getyritykset\n} = require('../db/SQL');\n\nconst sql = require('../db/SQL');\n\nmodule.exports = {\n  fetch: async (req, res) => {\n    //Ekan version jäänteitä\n    console.log(\"fetch started ...\");\n\n    try {\n      let n = req.body;\n      console.log(\"body: \" + JSON.stringify(req.body));\n      let y = await sql.getYritys(); //let t = await sql.getTilaukset(y.id);\n\n      console.log(\"done\");\n      res.json({\n        status: \"OK\",\n        yritykset: y\n      });\n    } catch (err) {\n      res.json({\n        status: \"NOT OK\",\n        msg: err\n      });\n    }\n  }\n  /*fetchKaikki: async (req, res) => {\r\n      console.log(\"fetch started ...\");\r\n      console.log(req.query);\r\n      let n = req.query;\r\n      let toimialat = [];\r\n      let yritykset;\r\n      try {        \r\n          toimialat = await sql.getToimialat();\r\n          console.log(\"Toimialat:\", toimialat);\r\n      }\r\n      catch(e)\r\n      {\r\n          console.log(\"ERROR: \", e)\r\n      }\r\n        try {\r\n          kayttaja = await sql.getYritys(n.nimi, n.ytunnus, n.toimiala_id);\r\n          console.log(\"Yritykset:\", yrituy);\r\n      }\r\n      catch(e)\r\n      {\r\n          console.log(\"ERROR: \", e)\r\n      }\r\n        let empty = {id:-1, toimiala : \"Choose\" };\r\n      res.render('index', {\r\n          title: \"Yritysten tiedot\",\r\n          toimialat : [empty, ...kayttaja],\r\n          yritys : [...yritykset]\r\n      });       \r\n  },*/\n\n};","map":{"version":3,"sources":["C:/Users/keijukoiso/Documents/Koulu/WEB/Mobiili/varasto/src/controllers/Controller.js"],"names":["getyritykset","require","sql","module","exports","fetch","req","res","console","log","n","body","JSON","stringify","y","getYritys","json","status","yritykset","err","msg"],"mappings":"AACA,MAAM;AAAEA,EAAAA;AAAF,IAAmBC,OAAO,CAAC,WAAD,CAAhC;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,WAAD,CAAnB;;AAEAE,MAAM,CAACC,OAAP,GAAiB;AAEbC,EAAAA,KAAK,EAAE,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAAa;AACpCC,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;;AAEA,QAAI;AACA,UAAIC,CAAC,GAAGJ,GAAG,CAACK,IAAZ;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAWG,IAAI,CAACC,SAAL,CAAeP,GAAG,CAACK,IAAnB,CAAvB;AAEA,UAAIG,CAAC,GAAG,MAAMZ,GAAG,CAACa,SAAJ,EAAd,CAJA,CAKA;;AAEAP,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AAEAF,MAAAA,GAAG,CAACS,IAAJ,CAAS;AAAEC,QAAAA,MAAM,EAAE,IAAV;AAAgBC,QAAAA,SAAS,EAAGJ;AAA5B,OAAT;AACH,KAVD,CAWA,OAAOK,GAAP,EAAY;AACRZ,MAAAA,GAAG,CAACS,IAAJ,CAAS;AAACC,QAAAA,MAAM,EAAG,QAAV;AAAoBG,QAAAA,GAAG,EAAGD;AAA1B,OAAT;AACH;AACJ;AAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAjDiB,CAAjB","sourcesContent":["\r\nconst { getyritykset } = require('../db/SQL');\r\nconst sql = require('../db/SQL');\r\n\r\nmodule.exports = {\r\n\r\n    fetch: async (req, res) => {            //Ekan version jäänteitä\r\n        console.log(\"fetch started ...\");\r\n\r\n        try {\r\n            let n = req.body;\r\n            console.log(\"body: \" + JSON.stringify(req.body));\r\n            \r\n            let y = await sql.getYritys();\r\n            //let t = await sql.getTilaukset(y.id);\r\n            \r\n            console.log(\"done\")\r\n\r\n            res.json({ status: \"OK\", yritykset : y });\r\n        }\r\n        catch (err) {\r\n            res.json({status : \"NOT OK\", msg : err});\r\n        }\r\n    },\r\n\r\n    /*fetchKaikki: async (req, res) => {\r\n        console.log(\"fetch started ...\");\r\n        console.log(req.query);\r\n        let n = req.query;\r\n        let toimialat = [];\r\n        let yritykset;\r\n        try {        \r\n            toimialat = await sql.getToimialat();\r\n            console.log(\"Toimialat:\", toimialat);\r\n        }\r\n        catch(e)\r\n        {\r\n            console.log(\"ERROR: \", e)\r\n        }\r\n\r\n        try {\r\n            kayttaja = await sql.getYritys(n.nimi, n.ytunnus, n.toimiala_id);\r\n            console.log(\"Yritykset:\", yrituy);\r\n        }\r\n        catch(e)\r\n        {\r\n            console.log(\"ERROR: \", e)\r\n        }\r\n\r\n        let empty = {id:-1, toimiala : \"Choose\" };\r\n        res.render('index', {\r\n            title: \"Yritysten tiedot\",\r\n            toimialat : [empty, ...kayttaja],\r\n            yritys : [...yritykset]\r\n        });       \r\n    },*/\r\n\r\n\r\n}"]},"metadata":{},"sourceType":"module"}